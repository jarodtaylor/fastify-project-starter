# Development Guide

This document tracks the development progress and architecture decisions for the Fastify + React Router 7 monorepo starter.

> **For Contributors**: See [CONTRIBUTING.md](./CONTRIBUTING.md) for detailed development setup, testing procedures, and contribution guidelines.

## âš ï¸ Important: pnpm Version Alignment

**Critical for CI/CD**: The pnpm version in CI workflows must match the version specified in `package.json`'s `packageManager` field.

**Current Setup**:

- `package.json`: `"packageManager": "pnpm@10.11.1"`
- CI workflows: `version: 10`

**Why this matters**: pnpm lockfile format changes between major versions. Using pnpm 8 to read a lockfile generated by pnpm 10 will fail with:

```
 WARN  Ignoring not compatible lockfile
 ERR_PNPM_NO_LOCKFILE  Cannot install with "frozen-lockfile"
```

**When updating pnpm**: Update both locations:

1. `package.json` â†’ `"packageManager": "pnpm@X.Y.Z"`
2. All `.github/workflows/*.yml` â†’ `version: X`

## âœ… Completed Features

### Core Infrastructure

- [x] **Monorepo Setup**: Turborepo + pnpm workspaces
- [x] **TypeScript Configuration**: Shared configs across packages
- [x] **Linting & Formatting**: Biome for consistent code style
- [x] **Development Tooling**: Hot reload, type checking, parallel builds

### Backend (Fastify API)

- [x] **Fastify Server**: Modern Node.js API framework
- [x] **Database Integration**: Prisma ORM with SQLite (easily switchable)
- [x] **Shared Database Package**: Reusable across multiple API apps
- [x] **CRUD Operations**: Complete Todo API with validation
- [x] **Error Handling**: Consistent error responses
- [x] **Environment Configuration**: Proper env var management

### Frontend (React Router 7)

- [x] **React Router 7**: Latest routing with SSR support
- [x] **Tailwind CSS**: Modern styling with responsive design
- [x] **Form Handling**: Server-side form actions
- [x] **Optimistic UI**: Immediate feedback with error handling
- [x] **Todo Application**: Complete CRUD interface

### CLI Generator âœ¨

- [x] **CLI Package**: `create-fastify-react-router` generator
- [x] **Template System**: Uses main project as living template
- [x] **Variable Replacement**: Customizes package names and scopes
- [x] **Interactive Options**: Database, ORM, linting choices
- [x] **Project Initialization**: Dependencies, git, database setup
- [x] **NPM Publishing**: Published to npm registry as `create-fastify-react-router@1.0.0`
- [x] **Documentation Cleanup**: User-focused README, proper contributing guidelines
- [x] **Open Source Ready**: Clear project structure and contribution workflow

## ğŸš€ CLI Usage

The CLI is now **live and published** on npm! Anyone can use:

```bash
# Create a new project
npx create-fastify-react-router my-app

# With options
npx create-fastify-react-router my-app --db postgres --lint eslint
```

**Status**: âœ… **Production Ready** - CLI is published and generating projects successfully

## ğŸ“‹ Next Steps

### CLI Enhancements

- [ ] **Interactive Prompts**: Full inquirer.js integration for better UX
- [ ] **Template Variants**: Multiple starter templates (minimal, full-featured, etc.)
- [ ] **Package Manager Choice**: Support for npm, yarn, bun
- [ ] **Deployment Options**: Vercel, Railway, Docker configurations
- [ ] **Testing Setup**: Jest/Vitest configuration options

### Template Improvements

- [ ] **Authentication**: Auth package with multiple providers
- [ ] **API Documentation**: OpenAPI/Swagger integration
- [ ] **Testing Examples**: Unit, integration, and E2E test examples
- [ ] **CI/CD Templates**: GitHub Actions, GitLab CI configurations
- [ ] **Monitoring**: Logging, metrics, and error tracking setup

### Publishing

- [x] **NPM Publishing**: Published as `create-fastify-react-router@1.0.0` âœ…
- [ ] **GitHub Release**: Automated releases with changelog
- [ ] **Documentation Site**: Comprehensive docs with examples
- [ ] **Video Tutorials**: Getting started and advanced usage

## ğŸ—ï¸ Architecture Decisions

### Database Package Strategy

**Decision**: Create a shared `packages/database` instead of per-app databases.
**Rationale**: Enables multiple API apps to share the same database schema while maintaining clean separation. Easy to split later if needed.

### Template Approach

**Decision**: Use the main project as the template source.
**Rationale**: Ensures the template is always up-to-date and functional. No need to maintain separate template files.

### CLI Implementation

**Decision**: Build CLI as a separate package within the monorepo.
**Rationale**: Keeps CLI code organized while allowing it to use the main project as a template. Easy to test and develop.

## ğŸ§ª Testing the CLI

```bash
# Build the CLI
cd cli && pnpm build

# Test locally
node dist/index.js test-project --no-install --no-git

# Test full flow
node dist/index.js my-app
cd my-app && pnpm install && pnpm dev
```

## ğŸ“¦ Package Structure

```
fastify-react-router-starter/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ api/              # Fastify API server
â”‚   â””â”€â”€ web/              # React Router 7 frontend
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ database/         # Shared Prisma database
â”‚   â”œâ”€â”€ shared-utils/     # Shared utilities
â”‚   â”œâ”€â”€ typescript-config/# Shared TypeScript config
â”‚   â””â”€â”€ ui/               # Shared UI components
â”œâ”€â”€ cli/                  # CLI generator package
â”‚   â”œâ”€â”€ src/              # CLI source code
â”‚   â”œâ”€â”€ dist/             # Built CLI
â”‚   â””â”€â”€ README.md         # CLI documentation
â”œâ”€â”€ data/                 # SQLite database files
â”œâ”€â”€ package.json          # Root package.json
â”œâ”€â”€ turbo.json            # Turborepo configuration
â””â”€â”€ pnpm-workspace.yaml   # Workspace configuration
```

This starter is now production-ready and includes everything needed to build modern fullstack applications with a powerful CLI generator for rapid project creation.
